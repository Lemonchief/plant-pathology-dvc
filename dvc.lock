schema: '2.0'
stages:
  prepare:
    cmd: python -m src.prepare_data --out data/raw --val-size 0.1 --seed 42
    deps:
    - path: src/prepare_data.py
      hash: md5
      md5: b4f9952466f2db3ec0cc9a7a7be0670b
      size: 1971
    outs:
    - path: data/raw
      hash: md5
      md5: 94918bb22daaae2ed11ccf43446191fd.dir
      size: 823687857
      nfiles: 3642
  augment:
    cmd: python -m src.augment_data --in data/raw --out data/augmented 
      --n-per-image 2 --max-per-class 6000 --seed 42
    deps:
    - path: data/raw
      hash: md5
      md5: 94918bb22daaae2ed11ccf43446191fd.dir
      size: 823687857
      nfiles: 3642
    - path: src/augment_data.py
      hash: md5
      md5: 94500bacfe58bc52112661a6456bbc62
      size: 2095
    outs:
    - path: data/augmented
      hash: md5
      md5: fbf2589e02c3222883cfac041fd6c22a.dir
      size: 897639646
      nfiles: 4733
  stats:
    cmd: python -m src.compute_stats --data data/raw --out artifacts/stats.json
    deps:
    - path: data/raw
      hash: md5
      md5: 94918bb22daaae2ed11ccf43446191fd.dir
      size: 823687857
      nfiles: 3642
    - path: src/compute_stats.py
      hash: md5
      md5: 0434380bef1e2f74d36e838e46a938c6
      size: 1021
    outs:
    - path: artifacts/stats.json
      hash: md5
      md5: 192aad23a448d2bd4b472bca378a2b6b
      size: 66
  train:
    cmd: python -m src.train --data data/raw --stats artifacts/stats.json 
      --model logreg --epochs 1 --lr 0.01 --batch-size 64 --weight-decay 0.0 
      --seed 42
    deps:
    - path: artifacts/stats.json
      hash: md5
      md5: 192aad23a448d2bd4b472bca378a2b6b
      size: 66
    - path: data/raw
      hash: md5
      md5: 94918bb22daaae2ed11ccf43446191fd.dir
      size: 823687857
      nfiles: 3642
    - path: src/models.py
      hash: md5
      md5: 5b1887059bd2757c3296a57d6793b08d
      size: 1228
    - path: src/train.py
      hash: md5
      md5: 998b95a7b261ee74f0fc4c9aa7156abc
      size: 3475
    - path: src/utils.py
      hash: md5
      md5: b59bb8c7bd9525a0679c0a003fe9bc96
      size: 1997
    outs:
    - path: metrics/train.json
      hash: md5
      md5: 67662aed2b2db8e0137271224d0d50a2
      size: 105
    - path: models/model.pt
      hash: md5
      md5: f2afb3099932137cd582cc1db330d581
      size: 14421
  evaluate:
    cmd: python -m src.evaluate --data data/raw --stats artifacts/stats.json 
      --model-path models/model.pt --out metrics/eval.json --cm 
      plots/confusion_matrix.csv
    deps:
    - path: artifacts/stats.json
      hash: md5
      md5: 192aad23a448d2bd4b472bca378a2b6b
      size: 66
    - path: data/raw
      hash: md5
      md5: 94918bb22daaae2ed11ccf43446191fd.dir
      size: 823687857
      nfiles: 3642
    - path: metrics/train.json
      hash: md5
      md5: 67662aed2b2db8e0137271224d0d50a2
      size: 105
    - path: models/model.pt
      hash: md5
      md5: f2afb3099932137cd582cc1db330d581
      size: 14421
    - path: src/evaluate.py
      hash: md5
      md5: 9b5a1dfcccc62a73e6ddad5630dc5caf
      size: 1838
    - path: src/models.py
      hash: md5
      md5: 5b1887059bd2757c3296a57d6793b08d
      size: 1228
    - path: src/utils.py
      hash: md5
      md5: b59bb8c7bd9525a0679c0a003fe9bc96
      size: 1997
    outs:
    - path: metrics/eval.json
      hash: md5
      md5: c30a9683d900826a2ddefe74254016e2
      size: 56
    - path: plots/confusion_matrix.csv
      hash: md5
      md5: 05bf57d706c3af06faff14a581359cd4
      size: 44
